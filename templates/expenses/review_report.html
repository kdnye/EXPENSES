{% extends "base.html" %}
{% block title %}Review Expense Report{% endblock %}
{% block content %}
<h1 class="h3">Review Report #{{ report.id }}</h1>
<p><strong>Employee:</strong> {{ report.employee.first_name or report.employee.email }}</p>
<p><strong>Status:</strong> {{ report.status }}</p>

<div class="table-responsive mb-3">
  <table class="table table-bordered">
    <thead><tr><th>Date</th><th>Type</th><th>GL</th><th>Vendor</th><th>Description</th><th>Amount</th><th>Receipt</th></tr></thead>
    <tbody>
      {% for line in report.lines %}
      <tr>
        <td>{{ line.date.strftime('%Y-%m-%d') }}</td>
        <td>{{ line.expense_type }}</td>
        <td>{{ line.gl_account }}</td>
        <td>{{ line.vendor }}</td>
        <td>{{ line.description }}</td>
        <td>${{ '%.2f'|format(line.amount) }}</td>
        <td>{% if line.receipt_url %}<a href="{{ line.receipt_url }}" target="_blank" rel="noopener">View</a>{% else %}<span class="text-muted">None</span>{% endif %}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
  <div class="mb-3">
    <label class="form-label">Rejection Comment (required for reject)</label>
    <textarea class="form-control" name="comment" rows="3"></textarea>
  </div>
  <div class="d-flex gap-2">
    <button class="btn btn-success" name="action" value="approve">Approve</button>
    <button class="btn btn-danger" name="action" value="reject">Reject</button>
  </div>
</form>
{% endblock %}
